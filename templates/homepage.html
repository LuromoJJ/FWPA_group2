<!-- Dominik Szewczyk -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Medicine Explainer & Reminder</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}" />
  <script src="{{ url_for('static', filename='js/homepage.js') }}"></script>
</head>
<body>

  <!-- Header -->
  <header class="navbar">
    <div class="logo">
      <a href="{{ url_for('medicine.homepage') }}">
        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Medicine Explainer Logo">
        <span>MedInfo</span>
      </a>
    </div>
    <nav class="nav-links" style="display: flex; align-items: center; gap: 15px;">
      {% if user.logged_in %}
        <a href="{{ url_for('profile.profile_page') }}" style="display: flex; flex-direction: column; align-items: center; text-decoration: none;">
          <img src="{{ url_for('static', filename='images/Profile_icon.png') }}" alt="Profile" style="width: 40px; height: 40px; border-radius: 50%;">
          <span style="font-size: 0.75rem; color: #333; margin-top: 5px;">Go to your profile</span>
        </a>
        <form method="POST" action="{{ url_for('auth.logout') }}" style="display: inline; margin: 0;">
          <button type="submit" class="login-btn" style="background-color: #dc3545; border: none; cursor: pointer;">Logout</button>
        </form>
      {% else %}
        <a href="{{ url_for('auth.login_page') }}" class="login-btn">Login</a>
      {% endif %}
    </nav>
  </header>

  <!-- Main content -->
  <main class="hero">
    <h1>Check your medicine</h1>

    <form class="search-form" method="POST" action="{{ url_for('medicine.search_medicine') }}">
      <input 
        type="text" 
        placeholder="Enter medicine name..." 
        name="medicine" 
        required
      />
      <button type="submit">Search</button>
    </form>

    <!-- ‚úÖ NEW: Quick Access Section (only for logged-in users) -->
    {% if user.logged_in %}
    <div style="max-width: 800px; margin: 3rem auto; display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
      
      <!-- Recent Searches -->
      <div style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <h3 style="margin: 0 0 1rem 0; color: var(--green-dark);">üîç Recent Searches</h3>
        <div id="historyList">
          <p style="color: #999;">Loading...</p>
        </div>
      </div>

      <!-- Favorites -->
      <div style="background: white; padding: 1.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        <h3 style="margin: 0 0 1rem 0; color: var(--green-dark);">‚ù§Ô∏è My Favorites</h3>
        <div id="favoritesList">
          <p style="color: #999;">Loading...</p>
        </div>
      </div>

    </div>
    {% endif %}

  </main>

  <!-- Footer -->
  <footer>
    <p>¬© 2025 Medicine Explainer & Reminder. All rights reserved.</p>
  </footer>

  {% if user.logged_in %}
  <script>
    // Load search history
    fetch('/api/search-history')
      .then(r => r.json())
      .then(data => {
        const list = document.getElementById('historyList');
        if (data.success && data.history.length > 0) {
          list.innerHTML = data.history.slice(0, 5).map(item => `
            <div style="padding: 10px; margin-bottom: 8px; background: #f9f9f9; border-radius: 8px;">
              <a href="/medicine/${item.medicine_name}" style="text-decoration: none; color: var(--green-dark); font-weight: bold;">
                ${item.medicine_name.charAt(0).toUpperCase() + item.medicine_name.slice(1)}
              </a>
              <small style="display: block; color: #666;">Searched ${item.search_count}x</small>
            </div>
          `).join('');
        } else {
          list.innerHTML = '<p style="color: #999;">No searches yet</p>';
        }
      });

    // Load favorites
    fetch('/api/favorites')
      .then(r => r.json())
      .then(data => {
        const list = document.getElementById('favoritesList');
        if (data.success && data.favorites.length > 0) {
          list.innerHTML = data.favorites.slice(0, 5).map(fav => `
            <div style="padding: 10px; margin-bottom: 8px; background: #f9f9f9; border-radius: 8px;">
              <a href="/medicine/${fav.medicine_name}" style="text-decoration: none; color: #e91e63; font-weight: bold;">
                ${fav.medicine_name.charAt(0).toUpperCase() + fav.medicine_name.slice(1)}
              </a>
            </div>
          `).join('');
        } else {
          list.innerHTML = '<p style="color: #999;">No favorites yet</p>';
        }
      });
  </script>
  {% endif %}

</body>
</html>